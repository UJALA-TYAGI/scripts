func createRequest(vars ScenarioConfig, endpoint string, method string) (*http.Request, error) {
    raw := vars.Get(NamingEndpoint)

    urlList, ok := raw.([]interface{})
    if !ok {
        return nil, fmt.Errorf("expected naming-api-endpoint to be a list of strings")
    }

    for _, u := range urlList {
        baseURL, ok := u.(string)
        if !ok {
            continue // skip non-string values
        }

        fullURL := baseURL + endpoint
        body := bytes.NewBuffer(nil)

        req, err := http.NewRequest(method, fullURL, body)
        if err != nil {
            continue
        }

        token, _, err := ida.GetIdaAccessToken(
            vars.Get(ClientId),
            vars.Get(NamingResourceUri),
            vars.Get(RedirectUrl),
            vars.Get(IdaProviderProd),
        )
        if err != nil {
            continue
        }

        req.Header.Set("Content-Type", "application/json")
        req.Header.Set("Authorization", "Bearer "+token)

        return req, nil // âœ… first successful request
    }

    return nil, fmt.Errorf("failed to create request for all naming-api-endpoints")
}
